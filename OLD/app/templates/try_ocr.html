<!-- app/templates/try_ocr.html @ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°å®Œäº†: 2025-07-26 -->
{% extends "base.html" %}

{% block head %}
<!-- PDF.jsãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®èª­ã¿è¾¼ã¿ -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
<script>
  // PDF.jsã®è¨­å®š
  if (typeof pdfjsLib !== 'undefined') {
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
  }
</script>
<!-- å…±é€šCSSãƒ•ã‚¡ã‚¤ãƒ« -->
<link rel="stylesheet" href="{{ url_for('static', path='css/common.css') }}">
<!-- å°‚ç”¨CSSãƒ•ã‚¡ã‚¤ãƒ« -->
<link rel="stylesheet" href="{{ url_for('static', path='css/try_ocr.css') }}">
{% endblock %}

{% block content %}
<div id="try-ocr-container">
  <!-- ä¸Šãƒšã‚¤ãƒ³ï¼š2åˆ†å‰²è¨­å®š -->
  <div id="pane-top">
    <!-- å·¦ä¸Šãƒšã‚¤ãƒ³ï¼šåŸºæœ¬è¨­å®šï¼ˆãƒ•ã‚¡ã‚¤ãƒ«é¸æŠå«ã‚€ï¼‰ -->
    <div id="top-left">
      <h1 class="section-title">âš™ï¸ åŸºæœ¬è¨­å®š</h1>
      <div class="form-section">
        <label for="file-input">ãƒ•ã‚¡ã‚¤ãƒ«æŒ‡å®š:</label>
        <input type="text" id="file-input" readonly placeholder="ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠã—ã¦ãã ã•ã„">
        <button type="button" id="browse-file">ğŸ“‚</button>
      </div>
      <input type="file" id="file-picker" style="display:none;" accept=".pdf,.png,.jpg,.jpeg">
      
      <div class="form-section">
        <label for="engine-select">OCRã‚¨ãƒ³ã‚¸ãƒ³:</label>
        <select id="engine-select" style="width:250px;">
          {% for engine in engines %}
          <option value="{{ engine }}">{{ engine }}</option>
          {% endfor %}
        </select>
      </div>
      
      <div class="form-section">
        <label for="page-num">ãƒšãƒ¼ã‚¸ç•ªå·:</label>
        <input type="number" id="page-num" value="1" min="0" step="1">
        <span style="margin-left:0.5em; color:#666; font-size:0.8em;">(0ã¯å…¨ãƒšãƒ¼ã‚¸)</span>
      </div>
      
      <div class="form-section">
        <label>PDFè¡¨ç¤º:</label>
        <label style="margin-left:0.5em;"><input type="radio" name="pdf_mode" value="embed" checked> è¡¨ç¤º</label>
        <label style="margin-left:0.5em;"><input type="radio" name="pdf_mode" value="hide"> éè¡¨ç¤º</label>
      </div>
      
      <div class="form-actions">
        <button id="process-btn" class="btn btn-primary">ğŸš€ OCRå®Ÿè¡Œ</button>
        <button id="cancel-btn" class="btn btn-cancel" disabled>âœ–ï¸ ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
        <label>
          <input type="checkbox" id="use-correction-dict" checked> èª¤å­—ä¿®æ­£
        </label>
        <button id="clear-btn" class="btn">ğŸ—‘ï¸ çµæœã‚¯ãƒªã‚¢</button>
        <button id="compare-all-btn" class="btn">ğŸ“Š å…¨ã‚¨ãƒ³ã‚¸ãƒ³æ¯”è¼ƒ</button>
      </div>
    </div>

    <!-- ä¸Šãƒšã‚¤ãƒ³ç”¨ã‚¹ãƒ—ãƒªãƒƒã‚¿ãƒ¼ -->
    <div id="top-splitter"></div>

    <!-- å³ä¸Šãƒšã‚¤ãƒ³ï¼šã‚¨ãƒ³ã‚¸ãƒ³èª¿æ•´ -->
    <div id="top-right">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 4px;">
        <h1 class="section-title">ğŸ”§ ã‚¨ãƒ³ã‚¸ãƒ³èª¿æ•´</h1>
        <div class="form-actions" style="margin: 0;">
          <button id="ocr-settings-btn" class="btn">è¨­å®š</button>
        </div>
      </div>
      <div id="engine-parameters">
        <p style="color:#888; font-size:0.9em;">OCRã‚¨ãƒ³ã‚¸ãƒ³ã‚’é¸æŠã™ã‚‹ã¨ã€èª¿æ•´é …ç›®ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</p>
      </div>
    </div>
  </div>

  <!-- ä¸Šä¸‹åˆ†å‰²ç”¨ã‚¹ãƒ—ãƒªãƒƒã‚¿ãƒ¼ -->
  <div id="vertical-splitter"></div>

  <!-- ä¸‹ãƒšã‚¤ãƒ³ï¼šçµæœã¨PDF -->
  <div id="pane-bottom">
    <div id="results-pane">
      <!-- å‡¦ç†ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼ˆæœ€ä¸Šä½ã®ã¿ï¼‰ -->
      <div id="processing-status" style="display: none;">
        <div class="status-message">å¾…æ©Ÿä¸­</div>
        <div class="status-timer"></div>
      </div>
      
      <!-- OCRçµæœè¡¨ç¤ºã‚¨ãƒªã‚¢ -->
      <div id="results-container">
        <!-- åˆæœŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯JavaScriptã§å‹•çš„ã«è¨­å®š -->
      </div>
    </div>

    <!-- ã‚¹ãƒ—ãƒªãƒƒã‚¿ãƒ¼ -->
    <div id="splitter"></div>

    <!-- PDFè¡¨ç¤ºãƒšã‚¤ãƒ³ -->
    <div id="pdf-pane">
      <iframe id="pdf-viewer" style="width:100%; height:100%; border:none;"></iframe>
    </div>
  </div>
</div>

<!-- å‡¦ç†ä¸­ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ -->
<div id="processing-overlay">
  <div class="spinner"></div>
  <div id="processing-message">OCRå‡¦ç†ä¸­â€¦</div>
</div>

<!-- æ©Ÿèƒ½åˆ¥JavaScriptãƒ•ã‚¡ã‚¤ãƒ« -->
<script src="{{ url_for('static', path='js/ocr_settings_dialog.js') }}"></script>
<script src="{{ url_for('static', path='js/try_ocr_pdf.js') }}"></script>
<script src="{{ url_for('static', path='js/try_ocr_engine.js') }}"></script>
<script src="{{ url_for('static', path='js/try_ocr_ui.js') }}"></script>
<script src="{{ url_for('static', path='js/try_ocr_resize.js') }}"></script>
<script src="{{ url_for('static', path='js/try_ocr_main.js') }}"></script>
{% endblock %}