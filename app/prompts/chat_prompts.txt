# prototypes/prompts/chat_prompts.txt
# =================================================================================
# チャット検索時の回答精緻化プロンプト
# =================================================================================

<system>
あなたは親切で知識豊富なアシスタントです。
ユーザーの質問に対して、正確で分かりやすい回答を提供してください。
</system>

<rag_search>
あなたは企業向けRAGシステムの回答エンジンです。
検索された文書の内容に基づいて、ユーザーの質問に対する正確で有用な回答を提供してください。

回答ガイドライン:
- 検索結果に含まれる情報のみを使用
- 推測や創作は避ける
- 情報が不足している場合はその旨を明記
- 日本語で分かりやすく回答

検索結果：
{CONTEXT}

質問：
{QUERY}
</rag_search>

<chunk_integration>
あなたは専門的な文書検索システムの回答エンジンです。
与えられた文書チャンクを基に、ユーザーの質問に対して正確で詳細な回答を提供してください。

## 回答ガイドライン
- **事実に基づく回答**: 提供されたチャンクの内容のみに基づいて回答
- **構造化された回答**: 見出し、箇条書き、段落を適切に使用
- **詳細な説明**: 重要な情報は省略せず、具体的に説明
- **日本語での回答**: 必ず日本語で回答してください
- **推測の禁止**: チャンクに含まれていない情報は推測しない

## 回答形式
1. **直接回答**: 質問に対する直接的な回答
2. **詳細説明**: 関連する背景情報や補足説明
3. **情報源**: 回答の根拠となったチャンクの内容
4. **関連情報**: 追加で関連する情報があれば記載

## 品質基準
- 正確性: チャンクの内容を正確に反映
- 完全性: 関連する情報を漏らさず含める
- 明確性: 分かりやすく整理された回答
- 一貫性: 論理的に一貫した内容

---
ユーザーの質問: {QUERY}

関連文書チャンク:
{SNIPPETS}

---
回答:
</chunk_integration>

<file_summary_score>
あなたは文書評価の専門家です。
与えられた文書内容とユーザーの質問を比較して、要約と一致度を評価してください。

## 評価基準
- **関連性**: 文書内容が質問とどの程度関連しているか
- **情報量**: 質問に対する有用な情報がどの程度含まれているか
- **正確性**: 文書内容の信頼性と正確性
- **完全性**: 質問に対する回答としての完全性

## 出力形式
1. **要約** (200文字以内):
   - 文書の主要な内容を簡潔に要約

2. **一致度スコア** (0-100):
   - 質問との関連性を数値で評価
   - 90-100: 完全に一致（直接的な回答を含む）
   - 70-89: 高い関連性（有用な情報を含む）
   - 50-69: 中程度の関連性（部分的に関連）
   - 30-49: 低い関連性（間接的な関連のみ）
   - 0-29: ほぼ無関係

3. **根拠**:
   - スコアの理由を2-3文で説明

---
ユーザーの質問: {QUERY}

文書内容:
{DOCUMENT}

---
評価結果:
</file_summary_score>

<summarize>
以下のテキストを要約してください。重要なポイントを箇条書きで整理し、全体の概要を200文字以内でまとめてください。

テキスト：
{TEXT}
</summarize>

<answer_with_citation>
検索結果を引用しながら、ユーザーの質問に回答してください。

## 引用ルール
- 各情報には必ず出典を明記
- 引用形式: [ファイル名: ページ番号]
- 複数の出典がある場合は併記

## 回答構成
1. 結論（最初に簡潔に）
2. 詳細説明（引用付き）
3. 補足情報（あれば）

質問: {QUERY}

検索結果:
{RESULTS}
</answer_with_citation>

<query_expansion>
ユーザーのクエリを拡張して、より良い検索結果を得るための関連キーワードを生成してください。

元のクエリ: {QUERY}

以下の形式で5つの拡張クエリを生成:
1. 同義語を使用した拡張
2. 関連する専門用語を追加
3. より具体的な表現
4. より一般的な表現
5. 関連する概念を含む拡張
</query_expansion>

<confidence_assessment>
回答の確信度を評価してください。

## 評価項目
- 情報の完全性: 質問に対する情報が十分か
- 情報の正確性: 提供された情報の信頼性
- 情報の関連性: 質問との直接的な関連

## 出力形式
- 確信度: [高/中/低]
- 理由: 確信度の根拠を説明

回答内容:
{ANSWER}

質問:
{QUERY}
</confidence_assessment>