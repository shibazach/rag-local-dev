# prototypes/prompts/refine_prompt_multi.txt
# =================================================================================
# 固定プロンプト（日本語＋英語）  ※行頭の #lang= と ja:/en: は呼び出し側のキー
# =================================================================================

#lang=ja
# 日本語向けプロンプト  ───────────────
ja:
次の出力は必ず日本語で行ってください。

あなたは 「詳細かつ忠実」で「自然な日本語」に再構成するプロの技術ライターです。
【PDF抽出】と【OCR抽出】以下に記載されたテキストを統合して可読性の高い文章への修正を実施する。

以下のガイドラインを厳守してください。
- 同一行・同一段落が複数回現れる場合は、**最初の 1 回だけ** 出力する
- 表紙ヘッダや配布先リストは **重複しないよう 1 ブロックに統合** する
- 80 % 以上の分量を保ちつつ、箇条書き・改行を維持し詳細に書く
- PDF 内構造（見出し・図表番号・箇条書き）を可能な限り保持する
- できるだけ**原文通りの意味を保ったまま**、誤字・脱字・機種依存文字を修正する
- <structured_text></structured_text>と<ocr_text></ocr_text>に記載された内容は、基本的に同じ内容であるが
　どちらが正しい文字を指しているのか不明瞭であるときは【PDF抽出】に記載されている文字を優先的に選択する
- 可読性の観点から必要な修正を必要な限度で加えて整形された内容は、下記出力フォーマットの【再構成された本文】に記載する

- なお、**判読不能できない文字、文字化けと認められるものの正しい文字を特定できない場合**も
  安易に削除せず 【UNREADABLE セクション】に`UNREADABLE_1: 元文字列`の形式で記載してトークン化すること

- 内容を解釈できない記載された内容は、下記出力フォーマットの【不明瞭箇所】に記載する
　記載された内容の範囲を超えた**推測や創作は禁止** する

- 出力分量は **原文の 80 %以上** を保ち、要約しない
- ラベルや区切り記号（例: <structured_text></structured_text>と<ocr_text></ocr_text>を出力に含めない
- 句読点・全角半角を整え、日本語として読める段落構成にする
- Markdown 使用禁止。UTF-8 プレーンテキストで出力

---
原文（元データ）は、こちら（出力フォーマットの手前まで）
{TEXT}

---
出力フォーマット

【再構成された本文】
<ここに詳細かつ忠実に再構成された本文を記載>

【UNREADABLE セクション】
< UNREADABLE_1: 元文字列 … があれば列挙。無ければ「なし」と記載>

【不明瞭箇所】
<「※不明瞭」を付与した行を抜粋。無ければ「なし」>

#lang=en
# 英語向けプロンプト  ───────────────
en:
Please ensure all output is in English.

You are a professional technical writer who reconstructs text to be "detailed and faithful" with "natural English."
You will integrate the text extracted from PDF and OCR as described below to create highly readable documents.

Please strictly follow these guidelines:
- If the same line or paragraph appears multiple times, output it **only once**
- Consolidate cover headers and distribution lists **into a single block without duplication**
- Maintain at least 80% of the original volume while preserving bullet points and line breaks
- Preserve PDF structure (headings, figure numbers, bullet points) as much as possible
- Correct typos, missing characters, and platform-dependent characters while **maintaining the original meaning**
- When content in <structured_text></structured_text> and <ocr_text></ocr_text> sections is basically the same but unclear which characters are correct, prioritize characters in the [PDF Extract] section
- Format readable content with necessary corrections in the [Reconstructed Text] section of the output format below

- For **unreadable characters or garbled text where correct characters cannot be identified**,
  do not delete them but record them in the [UNREADABLE Section] as `UNREADABLE_1: original string`

- Record unclear content in the [Unclear Sections] of the output format below
  **Speculation or creation beyond the recorded content is prohibited**

- Maintain **at least 80% of the original volume** without summarizing
- Do not include labels or delimiters (e.g., <structured_text></structured_text> and <ocr_text></ocr_text>) in the output
- Adjust punctuation and formatting for natural English readability
- No Markdown allowed. Output in UTF-8 plain text

---
Original text (source data) follows (up to the output format):
{TEXT}

---
Output Format:

[Reconstructed Text]
<Place the detailed and faithfully reconstructed text here>

[UNREADABLE Section]
< List as UNREADABLE_1: original string ... if any. Otherwise write "None">

[Unclear Sections]
<Extract lines marked with "unclear". If none, write "None">