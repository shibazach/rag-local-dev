<!-- app/templates/base.html @2025-07-18 00:00 UTC +9 -->
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ç ”ç©¶éƒ¨RAG</title>
  <link rel="stylesheet" href="/static/styles.css">
  <style>
    body {
      margin: 0;
      display: flex;
      height: 100vh;
      font-family: sans-serif;
    }
    nav {
      width: 200px;
      background: #f4f4f4;
      border-right: 1px solid #ddd;
      padding: 1em;
      box-sizing: border-box;
    }
    nav h2 {
      margin-top: 0;
      font-size: 1.2em;
    }
    nav ul {
      list-style: none;
      padding: 0;
    }
    nav li + li {
      margin-top: 0.5em;
    }
    nav a {
      text-decoration: none;
      color: #333;
    }
    nav a:hover {
      text-decoration: underline;
    }
    main {
      flex: 1;
      padding: 1em;
      overflow: auto;
    }
    /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ ã‚¿ã‚¤ãƒˆãƒ«çµ±ä¸€ã‚¹ã‚¿ã‚¤ãƒ« â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
    /* ingests/chat ãªã©ãƒ‡ãƒ¼ã‚¿æ•´å½¢ãƒšãƒ¼ã‚¸ç”¨ï¼šãƒ•ã‚©ãƒ³ãƒˆå°ãƒ»é«˜ã•åˆã‚ã› */
    .page-title {
      margin: 0 0 8px;
      font-size: 1.2em;
      line-height: 1.5em;
    }
    /* index.html ç”¨ï¼šãƒ•ã‚©ãƒ³ãƒˆãã®ã¾ã¾ãƒ»é«˜ã•ã ã‘åˆã‚ã› */
    .index-title {
      margin: 0 0 8px;
      line-height: 1.5em;
    }
  </style>
  <!-- REM: ãƒšãƒ¼ã‚¸å›ºæœ‰ã® head è¦ç´ ã‚’ã“ã“ã«è¿½åŠ  -->
  {% block head %}{% endblock %}
</head>
<body>
  <nav>
    <h2>ğŸ§  ç ”ç©¶éƒ¨RAG</h2>
    <ul>
      <li><a href="/ingest">âœï¸ ãƒ‡ãƒ¼ã‚¿æ•´å½¢/ç™»éŒ²</a></li>
      <li><a href="/chat">ğŸ” ãƒãƒ£ãƒƒãƒˆæ¤œç´¢</a></li>
    </ul>
    <!-- REM: ã‚·ã‚¹ãƒ†ãƒ ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°è¡¨ç¤ºç”¨ -->
    <hr>
    <div id="system-monitor">
      <p>CPU ä½¿ç”¨ç‡ï¼š<span id="cpu-usage">--</span>%</p>
      <p id="gpu-info" style="display:none">
        GPU ä½¿ç”¨ç‡ï¼š<span id="gpu-util">--</span>% /
        æ¶ˆè²»é›»åŠ›ï¼š<span id="gpu-power">--</span>W
      </p>
    </div>
    <!-- REM: ã‚·ã‚¹ãƒ†ãƒ ãƒ¢ãƒ‹ã‚¿ãƒªãƒ³ã‚°ç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆ -->
    <script>
      setInterval(async () => {
        try {
          const res = await fetch('/metrics');
          if (!res.ok) return;
          const j = await res.json();
          document.getElementById('cpu-usage').textContent = j.cpu.toFixed(1);
          if (j.gpu) {
            document.getElementById('gpu-info').style.display = 'block';
            document.getElementById('gpu-util').textContent  = j.gpu.util;
            document.getElementById('gpu-power').textContent = j.gpu.power.toFixed(1);
          }
        } catch (e) {
          console.error('metrics fetch error:', e);
        }
      }, 3000);
    </script>
  </nav>
  <main>
    {% block content %}{% endblock %}
  </main>
</body>
</html>