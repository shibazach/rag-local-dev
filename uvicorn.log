[config.py] LLM_MODEL = phi4-mini
[config.py] CUDA_AVAILABLE = False
[config.py] MULTIMODAL_ENABLED = False
üêõ [DEBUG] üöÄ Êñ∞„Åó„ÅÑRAG FastAPI„Ç¢„Éó„É™Ëµ∑Âãï‰∏≠...
üêõ [DEBUG] ‚Üí Running: uvicorn new.main:app --host 0.0.0.0 --port 8000 --reload --log-level warning
[config.py] CUDA_AVAILABLE = False
[config.py] MULTIMODAL_ENABLED = False
[config.py] LLM_MODEL = phi4-mini
[config.py] Database URL: postgresql://raguser:ragpass@ragdb:5432/rag
2025-07-31 08:35:07,289 INFO sqlalchemy.engine.Engine select pg_catalog.version()
2025-07-31 08:35:07,290 INFO sqlalchemy.engine.Engine [raw sql] {}
2025-07-31 08:35:07,290 INFO sqlalchemy.engine.Engine select current_schema()
2025-07-31 08:35:07,291 INFO sqlalchemy.engine.Engine [raw sql] {}
2025-07-31 08:35:07,291 INFO sqlalchemy.engine.Engine show standard_conforming_strings
2025-07-31 08:35:07,291 INFO sqlalchemy.engine.Engine [raw sql] {}
2025-07-31 08:35:07,292 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-07-31 08:35:07,292 INFO sqlalchemy.engine.Engine SELECT 1 FROM pg_extension WHERE extname = 'vector'
2025-07-31 08:35:07,293 INFO sqlalchemy.engine.Engine [generated in 0.00049s] {}
[database] pgvector extension already enabled
2025-07-31 08:35:07,294 INFO sqlalchemy.engine.Engine ROLLBACK
2025-07-31 08:35:07,295 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-07-31 08:35:07,299 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-07-31 08:35:07,299 INFO sqlalchemy.engine.Engine [generated in 0.00022s] {'table_name': 'files_blob', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-07-31 08:35:07,301 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-07-31 08:35:07,301 INFO sqlalchemy.engine.Engine [cached since 0.001654s ago] {'table_name': 'files_meta', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-07-31 08:35:07,301 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-07-31 08:35:07,302 INFO sqlalchemy.engine.Engine [cached since 0.00243s ago] {'table_name': 'files_text', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-07-31 08:35:07,302 INFO sqlalchemy.engine.Engine COMMIT
[database] Schema initialized successfully
2025-07-31 08:35:25,893 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-07-31 08:35:25,893 INFO sqlalchemy.engine.Engine SELECT COUNT(*) FROM (
            SELECT 
                fb.id,
                fm.file_name,
                fm.mime_type,
                fm.size,
                fm.page_count,
                fm.status,
                fm.created_at,
                fm.updated_at,
                ft.quality_score
            FROM files_blob fb
            JOIN files_meta fm ON fb.id = fm.blob_id
            LEFT JOIN files_text ft ON fb.id = ft.blob_id
         ORDER BY fm.created_at DESC) as subquery
2025-07-31 08:35:25,893 INFO sqlalchemy.engine.Engine [generated in 0.00044s] {}
2025-07-31 08:35:25,896 - rag_system - ERROR - Failed to get files list: (psycopg2.errors.UndefinedColumn) column fm.page_count does not exist
LINE 7:                 fm.page_count,
                        ^

[SQL: SELECT COUNT(*) FROM (
            SELECT 
                fb.id,
                fm.file_name,
                fm.mime_type,
                fm.size,
                fm.page_count,
                fm.status,
                fm.created_at,
                fm.updated_at,
                ft.quality_score
            FROM files_blob fb
            JOIN files_meta fm ON fb.id = fm.blob_id
            LEFT JOIN files_text ft ON fb.id = ft.blob_id
         ORDER BY fm.created_at DESC) as subquery]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-07-31 08:35:25,897 INFO sqlalchemy.engine.Engine ROLLBACK
2025-07-31 08:35:28,333 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-07-31 08:35:28,333 INFO sqlalchemy.engine.Engine SELECT COUNT(*) FROM (
            SELECT 
                fb.id,
                fm.file_name,
                fm.mime_type,
                fm.size,
                fm.page_count,
                fm.status,
                fm.created_at,
                fm.updated_at,
                ft.quality_score
            FROM files_blob fb
            JOIN files_meta fm ON fb.id = fm.blob_id
            LEFT JOIN files_text ft ON fb.id = ft.blob_id
         ORDER BY fm.created_at DESC) as subquery
2025-07-31 08:35:28,333 INFO sqlalchemy.engine.Engine [cached since 2.441s ago] {}
2025-07-31 08:35:28,334 - rag_system - ERROR - Failed to get files list: (psycopg2.errors.UndefinedColumn) column fm.page_count does not exist
LINE 7:                 fm.page_count,
                        ^

[SQL: SELECT COUNT(*) FROM (
            SELECT 
                fb.id,
                fm.file_name,
                fm.mime_type,
                fm.size,
                fm.page_count,
                fm.status,
                fm.created_at,
                fm.updated_at,
                ft.quality_score
            FROM files_blob fb
            JOIN files_meta fm ON fb.id = fm.blob_id
            LEFT JOIN files_text ft ON fb.id = ft.blob_id
         ORDER BY fm.created_at DESC) as subquery]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-07-31 08:35:28,335 INFO sqlalchemy.engine.Engine ROLLBACK
2025-07-31 08:35:30,466 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-07-31 08:35:30,466 INFO sqlalchemy.engine.Engine SELECT COUNT(*) FROM (
            SELECT 
                fb.id,
                fm.file_name,
                fm.mime_type,
                fm.size,
                fm.page_count,
                fm.status,
                fm.created_at,
                fm.updated_at,
                ft.quality_score
            FROM files_blob fb
            JOIN files_meta fm ON fb.id = fm.blob_id
            LEFT JOIN files_text ft ON fb.id = ft.blob_id
         ORDER BY fm.created_at DESC) as subquery
2025-07-31 08:35:30,466 INFO sqlalchemy.engine.Engine [cached since 4.573s ago] {}
2025-07-31 08:35:30,467 - rag_system - ERROR - Failed to get files list: (psycopg2.errors.UndefinedColumn) column fm.page_count does not exist
LINE 7:                 fm.page_count,
                        ^

[SQL: SELECT COUNT(*) FROM (
            SELECT 
                fb.id,
                fm.file_name,
                fm.mime_type,
                fm.size,
                fm.page_count,
                fm.status,
                fm.created_at,
                fm.updated_at,
                ft.quality_score
            FROM files_blob fb
            JOIN files_meta fm ON fb.id = fm.blob_id
            LEFT JOIN files_text ft ON fb.id = ft.blob_id
         ORDER BY fm.created_at DESC) as subquery]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-07-31 08:35:30,468 INFO sqlalchemy.engine.Engine ROLLBACK
WARNING:  StatReload detected changes in 'new/services/processing/processor.py'. Reloading...
[config.py] CUDA_AVAILABLE = False
[config.py] MULTIMODAL_ENABLED = False
[config.py] LLM_MODEL = phi4-mini
[config.py] Database URL: postgresql://raguser:ragpass@ragdb:5432/rag
2025-07-31 08:36:26,079 INFO sqlalchemy.engine.Engine select pg_catalog.version()
2025-07-31 08:36:26,079 INFO sqlalchemy.engine.Engine [raw sql] {}
2025-07-31 08:36:26,083 INFO sqlalchemy.engine.Engine select current_schema()
2025-07-31 08:36:26,083 INFO sqlalchemy.engine.Engine [raw sql] {}
2025-07-31 08:36:26,084 INFO sqlalchemy.engine.Engine show standard_conforming_strings
2025-07-31 08:36:26,084 INFO sqlalchemy.engine.Engine [raw sql] {}
2025-07-31 08:36:26,085 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-07-31 08:36:26,085 INFO sqlalchemy.engine.Engine SELECT 1 FROM pg_extension WHERE extname = 'vector'
2025-07-31 08:36:26,085 INFO sqlalchemy.engine.Engine [generated in 0.00028s] {}
[database] pgvector extension already enabled
2025-07-31 08:36:26,089 INFO sqlalchemy.engine.Engine ROLLBACK
2025-07-31 08:36:26,089 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-07-31 08:36:26,096 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-07-31 08:36:26,099 INFO sqlalchemy.engine.Engine [generated in 0.00318s] {'table_name': 'files_blob', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-07-31 08:36:26,102 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-07-31 08:36:26,102 INFO sqlalchemy.engine.Engine [cached since 0.006377s ago] {'table_name': 'files_meta', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-07-31 08:36:26,103 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-07-31 08:36:26,104 INFO sqlalchemy.engine.Engine [cached since 0.007927s ago] {'table_name': 'files_text', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-07-31 08:36:26,105 INFO sqlalchemy.engine.Engine COMMIT
WARNING:  StatReload detected changes in 'new/main.py'. Reloading...
[config.py] CUDA_AVAILABLE = False
[config.py] MULTIMODAL_ENABLED = False
[config.py] LLM_MODEL = phi4-mini
[config.py] Database URL: postgresql://raguser:ragpass@ragdb:5432/rag
2025-07-31 08:36:46,281 INFO sqlalchemy.engine.Engine select pg_catalog.version()
2025-07-31 08:36:46,281 INFO sqlalchemy.engine.Engine [raw sql] {}
2025-07-31 08:36:46,282 INFO sqlalchemy.engine.Engine select current_schema()
2025-07-31 08:36:46,283 INFO sqlalchemy.engine.Engine [raw sql] {}
2025-07-31 08:36:46,283 INFO sqlalchemy.engine.Engine show standard_conforming_strings
2025-07-31 08:36:46,284 INFO sqlalchemy.engine.Engine [raw sql] {}
2025-07-31 08:36:46,285 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-07-31 08:36:46,285 INFO sqlalchemy.engine.Engine SELECT 1 FROM pg_extension WHERE extname = 'vector'
2025-07-31 08:36:46,285 INFO sqlalchemy.engine.Engine [generated in 0.00039s] {}
[database] pgvector extension already enabled
2025-07-31 08:36:46,286 INFO sqlalchemy.engine.Engine ROLLBACK
2025-07-31 08:36:46,287 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-07-31 08:36:46,290 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-07-31 08:36:46,290 INFO sqlalchemy.engine.Engine [generated in 0.00020s] {'table_name': 'files_blob', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-07-31 08:36:46,291 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-07-31 08:36:46,291 INFO sqlalchemy.engine.Engine [cached since 0.001432s ago] {'table_name': 'files_meta', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-07-31 08:36:46,292 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-07-31 08:36:46,292 INFO sqlalchemy.engine.Engine [cached since 0.001904s ago] {'table_name': 'files_text', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-07-31 08:36:46,292 INFO sqlalchemy.engine.Engine COMMIT
WARNING:  StatReload detected changes in 'new/config.py'. Reloading...
[config.py] CUDA_AVAILABLE = False
[config.py] MULTIMODAL_ENABLED = False
[config.py] LLM_MODEL = phi4-mini
[config.py] Database URL: postgresql://raguser:ragpass@ragdb:5432/rag
2025-07-31 08:37:15,372 INFO sqlalchemy.engine.Engine select pg_catalog.version()
2025-07-31 08:37:15,372 INFO sqlalchemy.engine.Engine [raw sql] {}
2025-07-31 08:37:15,374 INFO sqlalchemy.engine.Engine select current_schema()
2025-07-31 08:37:15,374 INFO sqlalchemy.engine.Engine [raw sql] {}
2025-07-31 08:37:15,375 INFO sqlalchemy.engine.Engine show standard_conforming_strings
2025-07-31 08:37:15,375 INFO sqlalchemy.engine.Engine [raw sql] {}
2025-07-31 08:37:15,376 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-07-31 08:37:15,376 INFO sqlalchemy.engine.Engine SELECT 1 FROM pg_extension WHERE extname = 'vector'
2025-07-31 08:37:15,376 INFO sqlalchemy.engine.Engine [generated in 0.00041s] {}
[database] pgvector extension already enabled
2025-07-31 08:37:15,377 INFO sqlalchemy.engine.Engine ROLLBACK
2025-07-31 08:37:15,377 INFO sqlalchemy.engine.Engine BEGIN (implicit)
2025-07-31 08:37:15,381 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-07-31 08:37:15,381 INFO sqlalchemy.engine.Engine [generated in 0.00032s] {'table_name': 'files_blob', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-07-31 08:37:15,382 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-07-31 08:37:15,383 INFO sqlalchemy.engine.Engine [cached since 0.00202s ago] {'table_name': 'files_meta', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-07-31 08:37:15,384 INFO sqlalchemy.engine.Engine SELECT pg_catalog.pg_class.relname 
FROM pg_catalog.pg_class JOIN pg_catalog.pg_namespace ON pg_catalog.pg_namespace.oid = pg_catalog.pg_class.relnamespace 
WHERE pg_catalog.pg_class.relname = %(table_name)s AND pg_catalog.pg_class.relkind = ANY (ARRAY[%(param_1)s, %(param_2)s, %(param_3)s, %(param_4)s, %(param_5)s]) AND pg_catalog.pg_table_is_visible(pg_catalog.pg_class.oid) AND pg_catalog.pg_namespace.nspname != %(nspname_1)s
2025-07-31 08:37:15,384 INFO sqlalchemy.engine.Engine [cached since 0.003199s ago] {'table_name': 'files_text', 'param_1': 'r', 'param_2': 'p', 'param_3': 'f', 'param_4': 'v', 'param_5': 'm', 'nspname_1': 'pg_catalog'}
2025-07-31 08:37:15,385 INFO sqlalchemy.engine.Engine COMMIT
